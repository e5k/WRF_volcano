{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"WRF-Volcano tutorial This page is written by Alex Poulidis (Bremen Universit\u00e4t) and S\u00e9bastien Biass (Universit\u00e9 de Gen\u00e8ve) and is designed to provide a hands-on approach to running WRF for applications in volcanology. Feel free to use any of the material for research or education purposes, but we would be grateful if you could contribute back with any new material. Getting started Cluster documentation Yggdrasil (Universit\u00e9 de Gen\u00e8ve) WRF documentation \ud83d\udcd6 WRF user guide Download ERA5 data Using MARS (\u2192 UNIGE users) ERA5 data should be placed in /srv/beegfs/scratch/shares/wrf_volcano/MET/ERA5/case_name Case study The case-study is the Feb 2020 eruption of Taal volcano in the Philippines. Hourly ERA5 data has already been downloaded for the period 2020-02-10_00:00:00 \u2192 2020-02-20_23:59:59 and is located in /srv/beegfs/scratch/shares/wrf_volcano/MET/ERA5/Taal/ . Setup a run On the cluster, clone the WRF-volcano repository: git clone https://github.com/e5k/WRF_volcano Run ./setup_wrf.sh case_name , where case_name is your project/case name. This will: Create a folder named WRF_projects/case_name/ both on HOME and on scratch . The folder on the HOME partition contains the config files (i.e., namelist.* ) and are backed up. The folder on the scratch partition contains the WPS/ and WRF/ folders, which will store most of the data. Overview of the WRF workflow The process of running WRF consists of two steps: Pre-processing using the WRF Preprocessing System ( WPS ): WPS is a set of three programs whose collective role is to prepare input for real-data simulations Running WRF . flowchart TD classDef classA fill:#7e95af; classDef classB fill:#fc6f03; classDef classC fill:#a13ddb; T(Terrestrial):::classA subgraph WPS T --> geogrid--> metgrid M(MET):::classA --> ungrib --> ERA5-T:::classC --> metgrid namelist.wps:::classB -.-> geogrid namelist.wps:::classB -.-> metgrid namelist.wps:::classB -.-> ungrib namelist.wps:::classB -.-> calc_ecmwf_p calc_ecmwf_p --> PRES-T:::classC --> metgrid metgrid --> met_em_.dD:::classC end met_em_.dD:::classC --> real real --> wrfinput_dD:::classC --> WRF real --> wrfbdy_d01:::classC --> WRF namelist.input:::classB -.-> real namelist.input:::classB -.-> WRF --> wrfout_dD_T:::classC flowchart TD classDef classA fill:#7e95af; classDef classB fill:#fc6f03; classDef classC fill:#a13ddb; I(Input dataset):::classA O(Output file):::classC C(Configuration file):::classB P(Executable) Variables In the above flowchart and in the description below: T represents time is a string of format yyyy-mm-dd_hh D represents a domain numbered as 1 \u2192 n , where 1 is the outermost domain and n is the number of domains Setup WPS This section describes the steps required to setup the pre-processing part of WRF . \ud83d\udcd6 WPS user guide cd case_name/WPS Edit the namelist.wps configuration file for WPS \u2192 refer to this page for reference module load GCC/10.3.0 OpenMPI/4.1.1 WPS srun geogrid.exe Define the simulation domains, and to interpolate various terrestrial data sets to the model grids. \u2192 Outputs one NetCDF file per domain srun ungrib.exe Creates intermediary files (e.g., translate data from ERA, GFS or any other met model) \u2192 Creates one ERA5-T file per time step srun calc_ecmwf_p.exe Calculates pressure levels for specifically for ERA5 \u2192 Creates one PRES-T file per time step Info Not all reanalysis datasets have all the variables required for WRF and this step is specific to ERA5. srun metgrid.exe Interpolates the intermediate-format meteorological data that onto the simulation domains defined by geogrid \u2192 Creates one met_em_.dD... file per domain per time step Ouptut from metgrid is in WPS/output/ Using run_wps.sh All steps can be automatised by running sbatch run_wps.sh Case setup / WRF \ud83d\udcd6 User guide cd ../WRF Edit the namelist.input configuration file for WRF \u2192 refer to this page for reference. srun real.exe Reads the met_em... files and creates input and boundary files input files represent the atmospheric state at \\(t=0\\) \u2192 wrfinput_dD boundary files are tendencies (i.e., fluxes) at the border to represent future states \u2192 wrfbdy_d01 \u2192 only outer domain Info at \\(t=0\\) , everything is based on input data at \\(t>0\\) , input data only affect boundaries Job submission with sbatch wrf > Output in case_name/WRF/output Using run_wrf.sh All steps can be automatised by running sbatch run_wrf.sh . Adapt the number of required CPU using ntasks and -n as needed. Remember than requesting too many processors can prevent the run to start/complete (see this note ).","title":"Tutorial"},{"location":"#wrf-volcano-tutorial","text":"This page is written by Alex Poulidis (Bremen Universit\u00e4t) and S\u00e9bastien Biass (Universit\u00e9 de Gen\u00e8ve) and is designed to provide a hands-on approach to running WRF for applications in volcanology. Feel free to use any of the material for research or education purposes, but we would be grateful if you could contribute back with any new material.","title":"WRF-Volcano tutorial"},{"location":"#getting-started","text":"","title":"Getting started"},{"location":"#cluster-documentation","text":"Yggdrasil (Universit\u00e9 de Gen\u00e8ve)","title":"Cluster documentation"},{"location":"#wrf-documentation","text":"\ud83d\udcd6 WRF user guide","title":"WRF documentation"},{"location":"#download-era5-data","text":"Using MARS (\u2192 UNIGE users) ERA5 data should be placed in /srv/beegfs/scratch/shares/wrf_volcano/MET/ERA5/case_name","title":"Download ERA5 data"},{"location":"#case-study","text":"The case-study is the Feb 2020 eruption of Taal volcano in the Philippines. Hourly ERA5 data has already been downloaded for the period 2020-02-10_00:00:00 \u2192 2020-02-20_23:59:59 and is located in /srv/beegfs/scratch/shares/wrf_volcano/MET/ERA5/Taal/ .","title":"Case study"},{"location":"#setup-a-run","text":"On the cluster, clone the WRF-volcano repository: git clone https://github.com/e5k/WRF_volcano Run ./setup_wrf.sh case_name , where case_name is your project/case name. This will: Create a folder named WRF_projects/case_name/ both on HOME and on scratch . The folder on the HOME partition contains the config files (i.e., namelist.* ) and are backed up. The folder on the scratch partition contains the WPS/ and WRF/ folders, which will store most of the data.","title":"Setup a run"},{"location":"#overview-of-the-wrf-workflow","text":"The process of running WRF consists of two steps: Pre-processing using the WRF Preprocessing System ( WPS ): WPS is a set of three programs whose collective role is to prepare input for real-data simulations Running WRF . flowchart TD classDef classA fill:#7e95af; classDef classB fill:#fc6f03; classDef classC fill:#a13ddb; T(Terrestrial):::classA subgraph WPS T --> geogrid--> metgrid M(MET):::classA --> ungrib --> ERA5-T:::classC --> metgrid namelist.wps:::classB -.-> geogrid namelist.wps:::classB -.-> metgrid namelist.wps:::classB -.-> ungrib namelist.wps:::classB -.-> calc_ecmwf_p calc_ecmwf_p --> PRES-T:::classC --> metgrid metgrid --> met_em_.dD:::classC end met_em_.dD:::classC --> real real --> wrfinput_dD:::classC --> WRF real --> wrfbdy_d01:::classC --> WRF namelist.input:::classB -.-> real namelist.input:::classB -.-> WRF --> wrfout_dD_T:::classC flowchart TD classDef classA fill:#7e95af; classDef classB fill:#fc6f03; classDef classC fill:#a13ddb; I(Input dataset):::classA O(Output file):::classC C(Configuration file):::classB P(Executable) Variables In the above flowchart and in the description below: T represents time is a string of format yyyy-mm-dd_hh D represents a domain numbered as 1 \u2192 n , where 1 is the outermost domain and n is the number of domains","title":"Overview of the WRF workflow"},{"location":"#setup-wps","text":"This section describes the steps required to setup the pre-processing part of WRF . \ud83d\udcd6 WPS user guide cd case_name/WPS Edit the namelist.wps configuration file for WPS \u2192 refer to this page for reference module load GCC/10.3.0 OpenMPI/4.1.1 WPS srun geogrid.exe Define the simulation domains, and to interpolate various terrestrial data sets to the model grids. \u2192 Outputs one NetCDF file per domain srun ungrib.exe Creates intermediary files (e.g., translate data from ERA, GFS or any other met model) \u2192 Creates one ERA5-T file per time step srun calc_ecmwf_p.exe Calculates pressure levels for specifically for ERA5 \u2192 Creates one PRES-T file per time step Info Not all reanalysis datasets have all the variables required for WRF and this step is specific to ERA5. srun metgrid.exe Interpolates the intermediate-format meteorological data that onto the simulation domains defined by geogrid \u2192 Creates one met_em_.dD... file per domain per time step Ouptut from metgrid is in WPS/output/ Using run_wps.sh All steps can be automatised by running sbatch run_wps.sh","title":"Setup WPS"},{"location":"#case-setup-wrf","text":"\ud83d\udcd6 User guide cd ../WRF Edit the namelist.input configuration file for WRF \u2192 refer to this page for reference. srun real.exe Reads the met_em... files and creates input and boundary files input files represent the atmospheric state at \\(t=0\\) \u2192 wrfinput_dD boundary files are tendencies (i.e., fluxes) at the border to represent future states \u2192 wrfbdy_d01 \u2192 only outer domain Info at \\(t=0\\) , everything is based on input data at \\(t>0\\) , input data only affect boundaries Job submission with sbatch wrf > Output in case_name/WRF/output Using run_wrf.sh All steps can be automatised by running sbatch run_wrf.sh . Adapt the number of required CPU using ntasks and -n as needed. Remember than requesting too many processors can prevent the run to start/complete (see this note ).","title":"Case setup / WRF"},{"location":"changelog/","text":"Changelog 2022-07-24 The website was moved from an organisation (CERG-C.github.io) to a project (CERG-C) Github page. Now CERG-C.github.io contains only an index.html page with an automatic redirection.","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#2022-07-24","text":"The website was moved from an organisation (CERG-C.github.io) to a project (CERG-C) Github page. Now CERG-C.github.io contains only an index.html page with an automatic redirection.","title":"2022-07-24"},{"location":"contribute/","text":"Contribute to the teaching material This website is stored as a project site Github page and is stored on the CERG-C github repository. The documentation is written in Markdown , and built into a website using the static website generator MkDocs with the Material for MkDocs theme. Building and deploying the website requires some knowledge of Python and Git . Installing the website It is recommended to setup the website in a Conda environment rather than on the system's Python distribution. Setting up an environment Installing dependencies Contributing to the course Markdown native Library-specific Citations/references: As footnotes Abbreviations: Deploying the website We use mike to keep track of versions . The active version is always set with the latest label, so make sure it is set by default. From the root of the CERG-C repository, run from the terminal: mike set-default latest When working on a new version, push the website using a dummy label - here test . mike deploy --push --update-aliases 2022.1 test When happy with your changes, use the latest label. mike deploy --push --update-aliases 2022.1 latest Different versions are accessible with their version numbers. For instance, the url of version 2022.1 is https://cerg-c.github.io/CERG-C/2022.1/. Keep track of versions! Log the purpose of the versions here ]! Old website version The website was initially stored as an organisation site Github page in the repo CERG-C.github.io , for which deployment was done with: mkdocs gh-deploy --force --remote-branch main --config-file mkdocs.yml","title":"Contribute to the teaching material"},{"location":"contribute/#contribute-to-the-teaching-material","text":"This website is stored as a project site Github page and is stored on the CERG-C github repository. The documentation is written in Markdown , and built into a website using the static website generator MkDocs with the Material for MkDocs theme. Building and deploying the website requires some knowledge of Python and Git .","title":"Contribute to the teaching material"},{"location":"contribute/#installing-the-website","text":"It is recommended to setup the website in a Conda environment rather than on the system's Python distribution.","title":"Installing the website"},{"location":"contribute/#setting-up-an-environment","text":"","title":"Setting up an environment"},{"location":"contribute/#installing-dependencies","text":"","title":"Installing dependencies"},{"location":"contribute/#contributing-to-the-course","text":"","title":"Contributing to the course"},{"location":"contribute/#markdown-native","text":"","title":"Markdown native"},{"location":"contribute/#library-specific","text":"Citations/references: As footnotes Abbreviations:","title":"Library-specific"},{"location":"contribute/#deploying-the-website","text":"We use mike to keep track of versions . The active version is always set with the latest label, so make sure it is set by default. From the root of the CERG-C repository, run from the terminal: mike set-default latest When working on a new version, push the website using a dummy label - here test . mike deploy --push --update-aliases 2022.1 test When happy with your changes, use the latest label. mike deploy --push --update-aliases 2022.1 latest Different versions are accessible with their version numbers. For instance, the url of version 2022.1 is https://cerg-c.github.io/CERG-C/2022.1/. Keep track of versions! Log the purpose of the versions here ]!","title":"Deploying the website"},{"location":"contribute/#old-website-version","text":"The website was initially stored as an organisation site Github page in the repo CERG-C.github.io , for which deployment was done with: mkdocs gh-deploy --force --remote-branch main --config-file mkdocs.yml","title":"Old website version"},{"location":"howto/","text":"How to Random advices on some of the steps. Setup run duration The first 12h of any WRF run is spinup . This is the time required for the model to become quasi-steady state, so any run should at least be 12h. Setup domains General rules Setting up nested domains should be an iterative process. Make sure the parent domain is properly located before creating a child domain Domains should as much as possible having mountains on domains boundaries. The smaller the grid spacing, the more important mountains become (i.e., at the resolution of ERA5, topography is essentially flat) The outermost domain is the computationally cheapest one. The best practice is to set a large outer domain rather than push the child domains too close to the parent's boundaries The outermost domain controls the decomposition of the grid for run parallelisation. A small outer domain will prevent using a large number of CPU Setting up the outer domain Setup an outer domain , which should: Be centered on the point of interest Should have at least 100x100 points of the original data. The grid spacing of the outer domain should be \u2265 than 1/3rd of the grid spacing of the meteorological data. If nudging is used, the grid spacing of the outer domain must be the same than the original data. Setting up child domains Each child domain should be at most ~1/3rd of the parent domain in both size and grid spacing to avoid boundary effects Choose a time step The time step (sec) should be at most 6x the grid spacing (km) of the specific domain. Conceptually, the time step should be sufficiently small to prevent the wind from blowing through more than one grid cell (\u2192 CFL criterion). At first, try a run with the maximum resolution. If the model complains about a CFL breach , then reduce the time step. 1. Start with the maximum time step (e.g., 6 seconds for dx =1 km) 2. If it runs, \ud83d\udc4d 3. If not, reduce it to half 1. If it runs, increase it by a half 2. If not, reduce If it is necessary to reduce the time step by more than 1/4th of the original, then it is probably better to change the domain Test duration Tests do not require run completion \u2192 testing on the first 2h is enough Iterate! Test one domain at the time Monitor runs There are several ways to check the status of a run: tail rsl.error.0000 : Check computation time for each time step and estimate the remaining time Check files with ncview . Make sure that: The job is not outputting only nan though the job did not crash There is no checkerboard pattern following grid points w values are not ridiculously large (\u00b160 ms-1) and that w \u21920 close to the model top There is no presence of waves indicating an unrealistic interaction with the boundary (e.g., vertical or horizontal waves)","title":"How to"},{"location":"howto/#how-to","text":"Random advices on some of the steps.","title":"How to"},{"location":"howto/#setup-run-duration","text":"The first 12h of any WRF run is spinup . This is the time required for the model to become quasi-steady state, so any run should at least be 12h.","title":"Setup run duration"},{"location":"howto/#setup-domains","text":"","title":"Setup domains"},{"location":"howto/#general-rules","text":"Setting up nested domains should be an iterative process. Make sure the parent domain is properly located before creating a child domain Domains should as much as possible having mountains on domains boundaries. The smaller the grid spacing, the more important mountains become (i.e., at the resolution of ERA5, topography is essentially flat) The outermost domain is the computationally cheapest one. The best practice is to set a large outer domain rather than push the child domains too close to the parent's boundaries The outermost domain controls the decomposition of the grid for run parallelisation. A small outer domain will prevent using a large number of CPU","title":"General rules"},{"location":"howto/#setting-up-the-outer-domain","text":"Setup an outer domain , which should: Be centered on the point of interest Should have at least 100x100 points of the original data. The grid spacing of the outer domain should be \u2265 than 1/3rd of the grid spacing of the meteorological data. If nudging is used, the grid spacing of the outer domain must be the same than the original data.","title":"Setting up the outer domain"},{"location":"howto/#setting-up-child-domains","text":"Each child domain should be at most ~1/3rd of the parent domain in both size and grid spacing to avoid boundary effects","title":"Setting up child domains"},{"location":"howto/#choose-a-time-step","text":"The time step (sec) should be at most 6x the grid spacing (km) of the specific domain. Conceptually, the time step should be sufficiently small to prevent the wind from blowing through more than one grid cell (\u2192 CFL criterion). At first, try a run with the maximum resolution. If the model complains about a CFL breach , then reduce the time step. 1. Start with the maximum time step (e.g., 6 seconds for dx =1 km) 2. If it runs, \ud83d\udc4d 3. If not, reduce it to half 1. If it runs, increase it by a half 2. If not, reduce If it is necessary to reduce the time step by more than 1/4th of the original, then it is probably better to change the domain Test duration Tests do not require run completion \u2192 testing on the first 2h is enough Iterate! Test one domain at the time","title":"Choose a time step"},{"location":"howto/#monitor-runs","text":"There are several ways to check the status of a run: tail rsl.error.0000 : Check computation time for each time step and estimate the remaining time Check files with ncview . Make sure that: The job is not outputting only nan though the job did not crash There is no checkerboard pattern following grid points w values are not ridiculously large (\u00b160 ms-1) and that w \u21920 close to the model top There is no presence of waves indicating an unrealistic interaction with the boundary (e.g., vertical or horizontal waves)","title":"Monitor runs"},{"location":"setup_namelist_input/","text":"Setup namelist.input \ud83d\udcd6 User guide &time_control Description run_days , run_hours , run_minutes , run_seconds Total run time of the simulation. Usually set one of them and set the others to 0. One value. start_year , start_month , start_day , start_hour Start date 1 . end_year , end_month , end_day , end_hour Same as start date 1 . \u2757 The total run time needs to be \u2264 to end-start dates. Start and end need to coincide with the timestamp of input meteorological data. interval_seconds Interval of input data 4 . input_from_file Leave to true for every domain 1 . history_interval Interval (min) at which history is output 1 . frames_per_outfile Number of history_interval steps per NetCDF file 1 . restart Logical, set to .true. if starting a new simulation from a previous run. restart_interval Time (min) - see user guide. io_form_history , io_form_restart , io_form_input , io_form_boundary Leave to 2 \u2192 NetCDF. auxinput1_inname Location and naming of the met_em files. history_outname Location and naming of output files. Fall3d If you are planning on using Fall3d, adjust frames_per_outfile so all of the data is contained in one file . &domains Description time_step Time step for integration in integer seconds (recommended 6* dx in km for a typical case). time_step_fract_num , time_step_fract_den Numerator and denominator used to define fractions of time. max_dom The number of domains. e_we , e_sn Number of grid points per domain along west-east and south-north axes, one per domain 1 4 . e_vert Number of vertical levels 1 . dzstretch_s Leave as 1.1 . p_top_requested Minimum pressure (Pa) defining max domain altitude. num_metgrid_levels Number of vertical levels in the input data (i.e., 138 for ERA5). num_metgrid_soil_levels Number of soil levels (i.e., 3 for ERA5). dx = dy Grid spacing (m) 1 4 . grid_id Id of the domain 1 . \u2757 grid_id of outermost domain needs to be 1 . parent_id Id of the parent domain 1 . \u2757 parent_id of outermost domain needs to be 0 . i_parent_start , j_parent_start Grid point of the lower left corner in the parent domain where child domain starts 1 4 . parent_grid_ratio Grid ratio between parent and child domains. Needs to start with 1 4 . parent_time_step_ratio Ratio between parent and child domains. Needs to start with 1 and needs to be \u2265 than the equivalent parent_grid_ratio . feedback Feedback from nested to parent domain (0/1). smooth_option Whether the feedback data is smoothed. / &physics Physical parametrisation. Description physics_suite Choice of the scheme. mp_physics Hydrometeor microphysics, controls the formation of precipitations 1 2 . cu_physics Cumulus physics, parametrises cumulus. Only used if dx \u226510 km 1 2 . ra_lw_physics Long-wave radiation 1 2 . ra_sw_physics Short-wave radiation 1 2 . bl_pbl_physics Planetary boundary-layer parametrisation 1 2 . sf_sfclay_physics Surface layer options 1 2 . sf_surface_physics Land surface options 1 2 . radt Radiation time step (min) 1 . \u2757 Computationally expensive, usually set to 30 min. bldt Boundary layer time step (min) 1 3 . cudt Cumulus time step (min) 1 3 . icloud Leave to 1 . num_land_cat Number of land-use categories. sf_urban_physics Urban canopy model 1 . fractional_seaice Leave to default. &fdda / &dynamics Model integration options. Description hybrid_opt Leave at 2 . w_damping Manually prevent w from getting too big (0/1). diff_opt Turbulence and mixing options 1 . km_opt Eddy coefficient option \u2192 controls diffusion 1 . diff_6th_opt 6th order numerical diffusion \u2192 filters out numerical artifacts 1 . diff_6th_factor Factor for diff_6th_opt 1 . base_temp Base state sea-level temperature (K). damp_opt Upper-level damping \u2192 adds a response layer at the domain top that gradually attenuates gravity waves. zdamp Depth of damping layer from model top (m) 1 . dampcoef Coefficient for damping 1 . khdif , kvdif Horizontal and vertical diffusion. Only matters if km_opt = 1 1 . non_hydrostatic Logical, controls if the model is hydrostatic 1 . \u2757All domains should be the same. moist_adv_opt , scalar_adv_opt Advection options 1 . gwd_opt Gravity wave drag 1 . &bdy_control Boundary controls. Description spec_bdy_width Number of boundary grid points (int). Should be 5 . specified Should be .true. . / &grib2 / &namelist_quilt / One per domain, model reads up to max_dom set in &domains . \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 A value of -1 takes the default value of the scheme defined in physics_suite . \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 0 means every time step. \u21a9 \u21a9 Need to match values defined in namelist.wps . \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"WRF"},{"location":"setup_namelist_input/#setup-namelistinput","text":"\ud83d\udcd6 User guide","title":"Setup namelist.input"},{"location":"setup_namelist_input/#time_control","text":"Description run_days , run_hours , run_minutes , run_seconds Total run time of the simulation. Usually set one of them and set the others to 0. One value. start_year , start_month , start_day , start_hour Start date 1 . end_year , end_month , end_day , end_hour Same as start date 1 . \u2757 The total run time needs to be \u2264 to end-start dates. Start and end need to coincide with the timestamp of input meteorological data. interval_seconds Interval of input data 4 . input_from_file Leave to true for every domain 1 . history_interval Interval (min) at which history is output 1 . frames_per_outfile Number of history_interval steps per NetCDF file 1 . restart Logical, set to .true. if starting a new simulation from a previous run. restart_interval Time (min) - see user guide. io_form_history , io_form_restart , io_form_input , io_form_boundary Leave to 2 \u2192 NetCDF. auxinput1_inname Location and naming of the met_em files. history_outname Location and naming of output files. Fall3d If you are planning on using Fall3d, adjust frames_per_outfile so all of the data is contained in one file .","title":"&amp;time_control"},{"location":"setup_namelist_input/#domains","text":"Description time_step Time step for integration in integer seconds (recommended 6* dx in km for a typical case). time_step_fract_num , time_step_fract_den Numerator and denominator used to define fractions of time. max_dom The number of domains. e_we , e_sn Number of grid points per domain along west-east and south-north axes, one per domain 1 4 . e_vert Number of vertical levels 1 . dzstretch_s Leave as 1.1 . p_top_requested Minimum pressure (Pa) defining max domain altitude. num_metgrid_levels Number of vertical levels in the input data (i.e., 138 for ERA5). num_metgrid_soil_levels Number of soil levels (i.e., 3 for ERA5). dx = dy Grid spacing (m) 1 4 . grid_id Id of the domain 1 . \u2757 grid_id of outermost domain needs to be 1 . parent_id Id of the parent domain 1 . \u2757 parent_id of outermost domain needs to be 0 . i_parent_start , j_parent_start Grid point of the lower left corner in the parent domain where child domain starts 1 4 . parent_grid_ratio Grid ratio between parent and child domains. Needs to start with 1 4 . parent_time_step_ratio Ratio between parent and child domains. Needs to start with 1 and needs to be \u2265 than the equivalent parent_grid_ratio . feedback Feedback from nested to parent domain (0/1). smooth_option Whether the feedback data is smoothed. /","title":"&amp;domains"},{"location":"setup_namelist_input/#physics","text":"Physical parametrisation. Description physics_suite Choice of the scheme. mp_physics Hydrometeor microphysics, controls the formation of precipitations 1 2 . cu_physics Cumulus physics, parametrises cumulus. Only used if dx \u226510 km 1 2 . ra_lw_physics Long-wave radiation 1 2 . ra_sw_physics Short-wave radiation 1 2 . bl_pbl_physics Planetary boundary-layer parametrisation 1 2 . sf_sfclay_physics Surface layer options 1 2 . sf_surface_physics Land surface options 1 2 . radt Radiation time step (min) 1 . \u2757 Computationally expensive, usually set to 30 min. bldt Boundary layer time step (min) 1 3 . cudt Cumulus time step (min) 1 3 . icloud Leave to 1 . num_land_cat Number of land-use categories. sf_urban_physics Urban canopy model 1 . fractional_seaice Leave to default.","title":"&amp;physics"},{"location":"setup_namelist_input/#fdda","text":"/","title":"&amp;fdda"},{"location":"setup_namelist_input/#dynamics","text":"Model integration options. Description hybrid_opt Leave at 2 . w_damping Manually prevent w from getting too big (0/1). diff_opt Turbulence and mixing options 1 . km_opt Eddy coefficient option \u2192 controls diffusion 1 . diff_6th_opt 6th order numerical diffusion \u2192 filters out numerical artifacts 1 . diff_6th_factor Factor for diff_6th_opt 1 . base_temp Base state sea-level temperature (K). damp_opt Upper-level damping \u2192 adds a response layer at the domain top that gradually attenuates gravity waves. zdamp Depth of damping layer from model top (m) 1 . dampcoef Coefficient for damping 1 . khdif , kvdif Horizontal and vertical diffusion. Only matters if km_opt = 1 1 . non_hydrostatic Logical, controls if the model is hydrostatic 1 . \u2757All domains should be the same. moist_adv_opt , scalar_adv_opt Advection options 1 . gwd_opt Gravity wave drag 1 .","title":"&amp;dynamics"},{"location":"setup_namelist_input/#bdy_control","text":"Boundary controls. Description spec_bdy_width Number of boundary grid points (int). Should be 5 . specified Should be .true. . /","title":"&amp;bdy_control"},{"location":"setup_namelist_input/#grib2","text":"/","title":"&amp;grib2"},{"location":"setup_namelist_input/#namelist_quilt","text":"/ One per domain, model reads up to max_dom set in &domains . \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 A value of -1 takes the default value of the scheme defined in physics_suite . \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 0 means every time step. \u21a9 \u21a9 Need to match values defined in namelist.wps . \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"&amp;namelist_quilt"},{"location":"setup_namelist_wps/","text":"Setup namelist.wps \ud83d\udcd6 Lesson , WPS user guide &share Description wrf_core Should be ARW max_dom Number of domains start_date yyyy-mm-dd_hh:mm:ss , one per domain, most likely they will start at the same time end_date Same as start_ interval_seconds Interval in seconds between input data (i.e., 3600 for hourly ERA5) io_form_geogrid 2 , don't change &geogrid Description parent_id 1 2 Number of parent domains, first one should always be 1 parent_grid_ratio 1 2 Ratio between grid spacing between parent and child, should be an odd number i_parent_start 1 2 x grid point within the parent domain at which the ll corner of the child domain starts j_parent_start 1 2 y grid point within the parent domain at which the ll corner of the child domain starts e_we , e_sn 1 Number of grid points along w-e ( x ) and along s-n ( y ) axes 3 . Must be divisible by parent_grid_ratio +1 geog_data_res 1 Use default \u2192 terrestrial dataset used dx = dy 4 Grid spacing of the outermost domain map_projection Map projection ref_lat , ref_lon Reference of the center of the outermost domain truelat1 , truelat2 To check, projection-specific stand_lon Should be the same as ref_lon geog_data_path Path to the source static terrestrial datasets opt_geogrid_tbl_path Leave as it is for now &ungrib Description out_format WPS , \u2757 Should not change prefix Prefix to names of temporary files (e.g., ERA5 ) &metgrid Description fg_name Prefixes of the names we want to read, WPS \u2192\u2757 should not change prefix Prefix to names of temporary files, e.g., ERA5 , PRES 5 io_form_metgrid 2 opt_output_from_metgrid_path Output path opt_metgrid_tbl_path Output path to tables Coma-delimited values, there can be more but the program will only read the n \\(^{th}\\) first values, where n= max_dom \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 First value should always be 1 \u21a9 \u21a9 \u21a9 \u21a9 Means that u component is positive towards the E and v component positive towards the N \u21a9 For a phenomenon to be captured/resolved, the grid spacing should be 6 times less than the typical length of the phenomenon \u21a9 ERA5 requires the PRES variable created by calc_ecmwf_p \u21a9","title":"WPS"},{"location":"setup_namelist_wps/#setup-namelistwps","text":"\ud83d\udcd6 Lesson , WPS user guide","title":"Setup namelist.wps"},{"location":"setup_namelist_wps/#share","text":"Description wrf_core Should be ARW max_dom Number of domains start_date yyyy-mm-dd_hh:mm:ss , one per domain, most likely they will start at the same time end_date Same as start_ interval_seconds Interval in seconds between input data (i.e., 3600 for hourly ERA5) io_form_geogrid 2 , don't change","title":"&amp;share"},{"location":"setup_namelist_wps/#geogrid","text":"Description parent_id 1 2 Number of parent domains, first one should always be 1 parent_grid_ratio 1 2 Ratio between grid spacing between parent and child, should be an odd number i_parent_start 1 2 x grid point within the parent domain at which the ll corner of the child domain starts j_parent_start 1 2 y grid point within the parent domain at which the ll corner of the child domain starts e_we , e_sn 1 Number of grid points along w-e ( x ) and along s-n ( y ) axes 3 . Must be divisible by parent_grid_ratio +1 geog_data_res 1 Use default \u2192 terrestrial dataset used dx = dy 4 Grid spacing of the outermost domain map_projection Map projection ref_lat , ref_lon Reference of the center of the outermost domain truelat1 , truelat2 To check, projection-specific stand_lon Should be the same as ref_lon geog_data_path Path to the source static terrestrial datasets opt_geogrid_tbl_path Leave as it is for now","title":"&amp;geogrid"},{"location":"setup_namelist_wps/#ungrib","text":"Description out_format WPS , \u2757 Should not change prefix Prefix to names of temporary files (e.g., ERA5 )","title":"&amp;ungrib"},{"location":"setup_namelist_wps/#metgrid","text":"Description fg_name Prefixes of the names we want to read, WPS \u2192\u2757 should not change prefix Prefix to names of temporary files, e.g., ERA5 , PRES 5 io_form_metgrid 2 opt_output_from_metgrid_path Output path opt_metgrid_tbl_path Output path to tables Coma-delimited values, there can be more but the program will only read the n \\(^{th}\\) first values, where n= max_dom \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 First value should always be 1 \u21a9 \u21a9 \u21a9 \u21a9 Means that u component is positive towards the E and v component positive towards the N \u21a9 For a phenomenon to be captured/resolved, the grid spacing should be 6 times less than the typical length of the phenomenon \u21a9 ERA5 requires the PRES variable created by calc_ecmwf_p \u21a9","title":"&amp;metgrid"},{"location":"versions/","text":"Versions v2022.cerg 2022 CERG-C teaching","title":"Versions"},{"location":"versions/#versions","text":"","title":"Versions"},{"location":"versions/#v2022cerg","text":"2022 CERG-C teaching","title":"v2022.cerg"}]}